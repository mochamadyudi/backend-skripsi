{"version":3,"sources":["../../../../src/api/middlewares/auth/index.js"],"names":["verifyCurrentUser","jwt","YuyuidConfig","auth","req","res","next","headers","authorization","split","token","decoded","verify","jwtSecret","user","err","status","json","message"],"mappings":"AAAA,OAAOA,iBAAP,MAA8B,qBAA9B;AACA,OAAOC,GAAP,MAAgB,cAAhB;AACA,SAAQC,YAAR,QAA2B,gBAA3B;;AAEA,MAAMC,OAAO,CAACC,GAAD,EAAKC,GAAL,EAASC,IAAT,KAAiB;AAC1B,QAAI;AACA,YACKF,IAAIG,OAAJ,CAAYC,aAAZ,IAA6BJ,IAAIG,OAAJ,CAAYC,aAAZ,CAA0BC,KAA1B,CAAgC,GAAhC,EAAqC,CAArC,MAA4C,OAA1E,IACCL,IAAIG,OAAJ,CAAYC,aAAZ,IAA6BJ,IAAIG,OAAJ,CAAYC,aAAZ,CAA0BC,KAA1B,CAAgC,GAAhC,EAAqC,CAArC,MAA4C,QAF9E,EAGE;AACE,kBAAMC,QAAQN,IAAIG,OAAJ,CAAYC,aAAZ,CAA0BC,KAA1B,CAAgC,GAAhC,EAAqC,CAArC,CAAd;;AAEA,kBAAME,UAAUV,IAAIW,MAAJ,CAAWF,KAAX,EAAiBR,aAAaW,SAA9B,CAAhB;AACAT,gBAAIU,IAAJ,GAAWH,QAAQG,IAAnB;AACAR;AACH;AACJ,KAXD,CAWE,OAAOS,GAAP,EAAY;AACVV,YAAIW,MAAJ,CAAW,GAAX,EAAgBC,IAAhB,CAAqB,EAAEC,SAAS,mBAAX,EAArB;AACH;AACJ,CAfD;AAgBA,eAAe,EAACf,IAAD,EAAOH,iBAAP,EAAf","file":"index.js","sourcesContent":["import verifyCurrentUser from './verifyCurrentUser'\r\nimport jwt from \"jsonwebtoken\";\r\nimport {YuyuidConfig} from \"@yuyuid/config\";\r\n\r\nconst auth = (req,res,next)=> {\r\n    try {\r\n        if (\r\n            (req.headers.authorization && req.headers.authorization.split(\" \")[0] === \"Token\") ||\r\n            (req.headers.authorization && req.headers.authorization.split(\" \")[0] === \"Bearer\")\r\n        ) {\r\n            const token = req.headers.authorization.split(\" \")[1]\r\n\r\n            const decoded = jwt.verify(token,YuyuidConfig.jwtSecret);\r\n            req.user = decoded.user;\r\n            next();\r\n        }\r\n    } catch (err) {\r\n        res.status(401).json({ message: \"Token isnt valid!\" });\r\n    }\r\n}\r\nexport default {auth, verifyCurrentUser}\r\n"]}